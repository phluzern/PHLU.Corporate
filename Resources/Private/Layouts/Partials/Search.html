{namespace neos=Neos\Neos\ViewHelpers}
{namespace ts=Neos\Fusion\ViewHelpers}
{namespace nl=Neoslive\Hybridsearch\ViewHelpers}

<div class="row" data-ng-controller="SearchCtrl" id="search">
    <div data-ng-class="{'hasSearchResults': siteSearch != '', 'noSearchResults': siteSearch == ''}"
         class="noSearchResults ">
        <div class="col-xs-12 phlu-searchresults">
            <div class="close" data-ng-click="stopSearch();"></div>

            <div class="searchresults-count" data-ng-show="result.isLoading() === false">Suchergebnisse
                {{siteSearch}}
                ({{result.count()}})
            </div>
            <div class="searchresults-count" data-ng-show="result.isLoading()">Suchergebnisse {{siteSearch}}
            </div>
            <div class="globalSearchLoadingScreen" data-ng-if="result.isLoading()">
                <img src="{f:uri.resource(package: 'Phlu.Corporate', path: 'Images/loading.svg')}"
                     alt="loading"/>
            </div>

            <div class="turbo-link-result" data-ng-if="result.countTurboNodes()">
                <div class="result turbonode"
                     ng-repeat="(index,node) in result.getTurboNodes() | orderBy:'-score'"
                     ng-if="index === 0">
                    <search data="node"></search>
                </div>
            </div>

            <div class="phlu-corporate-tags-menu" data-ng-if="result.getGrouped().count() > 1">
                <div class="row subjectsfilternav ">
                    <div class="col-xs-12">
                        <div class="row filter-bar">
                            <div class="col-xs-12">
                                <ul class="nav nav-pills nav-justified" role="tablist">
                                    <li class="nav-item clickable " role="menuitem">
                                        <a class="nav-link all" data-ng-click="setLastActiveTabname('alle')"
                                           data-ng-class="{active: lastActiveTabName == 'alle'}"
                                           data-toggle="tab" data-target="#alle" href="#" role="tab">Alle</a>
                                    </li>
                                    <li class="nav-item clickable"
                                        ng-repeat="group in result.getGrouped().getItems()">

                                        <a class="nav-link"
                                           data-ng-click="setLastActiveTabname(group.getLabel())"
                                           data-ng-class="{active: lastActiveTabName == group.getLabel()}"
                                           data-toggle="tab" data-target="#{{group.getLabel()}}" href="#"
                                           role="tab"><span node-type name="{{group.getLabel()}}"></span>
                                            <span>({{group.count()}})</span></a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


            <div class="row results-table" data-ng-if="result.getGrouped().count() > 1">
                <div class="col-xs-12 tab-content">

                    <div class="result-panel tab-pane nofilter fade"
                         data-ng-class="{active: lastActiveTabName == 'alle', in: lastActiveTabName == 'alle'}"
                         id="alle" role="tabpanel">
                        <div class="row results-table results-quick-result"
                             data-ng-if="result.getQuickInfo().items.length">
                            <div class="col-xs-12 tab-content">

                                <div class="info row">
                                    <div data-ng-if="result.getQuickInfo().items[0].term == ''"
                                         class="col-xs-9 table-responsive topnode">
                                        <search data="result.getQuickInfo().node" view="group"></search>
                                    </div>
                                    <div data-ng-if="result.getQuickInfo().items[0].term != ''"
                                         class="col-xs-9 table-responsive"
                                         data-ng-class="{'col-xs-12': !result.getQuickInfo().node.getProperty('image') || result.getQuickInfo().items.length > 2}">
                                        <div class="title">
                                            <search data="result.getQuickInfo().node" view="all"></search>
                                        </div>
                                        <table class="table">
                                            <tr data-ng-repeat="t in result.getQuickInfo().items">
                                                <td data-ng-if="result.getQuickInfo().items.length > 1">
                                                    {{t.term}}
                                                </td>
                                                <td>
                                                            <span data-ng-if="result.getQuickInfo().items.length == 1"
                                                                  class="single-term">{{t.term}}<br></span>
                                                    <span data-ng-bind-html="t.value"
                                                          data-ng-class="{single: result.getQuickInfo().items.length == 1}"></span>
                                                </td>
                                            </tr>
                                        </table>

                                    </div>
                                    <div class="col-xs-3 img"
                                         data-ng-if="result.getQuickInfo().node.getProperty('image') && result.getQuickInfo().items.length < 3">
                                        <div>
                                            <img ng-src="{{result.getQuickInfo().node.getProperty('image').url}}"
                                                 title="{{result.getQuickInfo().node.getProperty('image').title}}"
                                                 class="img-fluid"/>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>


                        <div class="table-responsive">

                            <table class="table">
                                <tbody>
                                <tr ng-repeat="node in result.getNodes(limit['all'] === undefined ? 10 : limit['all'],filterAllResults,'_document.identifier')">
                                    <td data-node-id="{{node.getIdentifier()}}">
                                        <search data="node" view="all"></search>
                                    </td>
                                </tr>

                                <tfoot class="">
                                <tr>
                                    <td class="col-center">
                                        <a data-ng-click="limit['all'] === undefined ? limit['all'] = 10 : limit['all'] = limit['all'] + 10"
                                           class="btn loadMore"
                                           data-ng-if="result.count() > limit['all'] || (result.count() > 9 && limit['all'] === undefined)">
                                            mehr anzeigen
                                            <span>
                                                <span data-ng-if="limit['all'] === undefined ? limit['all'] = 10 : limit['all'] = limit['all']"
                                                      data-ng-bind="limit['all']"></span>
                                                <span class="counter-divider">von</span>
                                                <span data-ng-bind="result.count()"></span>
                                            </span>
                                        </a>
                                    </td>
                                </tr>
                                </tfoot>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="result-panel tab-pane nofilter fade "
                         data-ng-class="{active: lastActiveTabName == group.getLabel(), in: lastActiveTabName == group.getLabel()}"
                         id="{{group.getLabel()}}" role="tabpanel"
                         ng-repeat="group in result.getGrouped().getItems()">

                        <div data-ng-switch="group.getLabel()"
                             data-ng-if="lastActiveTabName == group.getLabel()">

                            <div class="ppdb-list" data-ng-switch-when="Standorte">
                                <div data-ng-controller="LocationCtrl" class="phlu-locations">
                                    <span data-ng-init="addNodes(group.getNodes());"></span>

                                    <div class="row google-maps-iframe ">

                                        <div class="col-xs-12 locationsMap phlu-locations-search">

                                        </div>


                                    </div>
                                    <div class="row">
                                        <div class="col-xs-12">
                                            <div class=" table-responsive phlu-corporate-table">
                                                <table class="table first-col-hidden-">
                                                    <tbody class="neos-contentcollection">
                                                    <tr class=" phlu-corporate-table-row"
                                                        data-ng-repeat="node in result.getNodes() | orderBy:'getDocumentNode().getSortingIndex()'"
                                                        data-ng-if="locations[node.identifier]">
                                                        <th class=" col-percent-Automatisch ">
                                                            <span> {{node.getProperty('name')}}</span>
                                                            <div class="mobile-view-columns">

                                                                <address>
                                                                    {{node.getProperty('organisation')}}<br>
                                                                    <span>{{node.getProperty('street')}}</span><br>
                                                                    <span data-ng-if="node.getProperty('street2') != ''">{{node.getProperty('street2')}}<br></span>
                                                                    <span data-ng-if="node.getProperty('zip') != ''">{{node.getProperty('zip')}} {{node.getProperty('city')}}<br></span>

                                                                    <div class="telephone"
                                                                         data-ng-if="node.getProperty('phone') != ''">
                                                                        <i class="fa fa-phone"
                                                                           aria-hidden="true"></i>
                                                                        {{node.getProperty('phone')}}<br>
                                                                    </div>
                                                                    <a class="content-link-email-contact-person"
                                                                       data-ng-if="node.getProperty('email') != ''"
                                                                       href="mailto:{{node.getProperty('email')}}">{{node.getProperty('email')}}</a><br>
                                                                </address>

                                                                <span class="details-link-cell">
                                                                            <a class="btn btn-primary"
                                                                               href="{{node.getUrl()}}">
                                                                                Details
                                                                            </a>
                                                                        </span>
                                                            </div>
                                                        </th>
                                                        <td>

                                                            <address>
                                                                {{node.getProperty('organisation')}}<br>
                                                                <span>{{node.getProperty('street')}}</span><br>
                                                                <span data-ng-if="node.getProperty('street2') != ''">{{node.getProperty('street2')}}<br></span>
                                                                <span data-ng-if="node.getProperty('zip') != ''">{{node.getProperty('zip')}} {{node.getProperty('city')}}<br></span>

                                                                <div class="telephone"
                                                                     data-ng-if="node.getProperty('phone') != ''">
                                                                    <i class="fa fa-phone"
                                                                       aria-hidden="true"></i>
                                                                    {{node.getProperty('phone')}}<br>
                                                                </div>
                                                                <a class="content-link-email-contact-person"
                                                                   data-ng-if="node.getProperty('email') != ''"
                                                                   href="mailto:{{node.getProperty('email')}}">{{node.getProperty('email')}}</a><br>
                                                            </address>

                                                        </td>
                                                        <td class="details-link-cell">
                                                            <a class="btn btn-primary" href="{{node.getUrl()}}">
                                                                Details
                                                            </a>
                                                        </td>
                                                    </tr>


                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>


                            <div class="ppdb-list" data-ng-switch-when="Publikationen">

                                <div class="table-responsive"
                                     data-ng-repeat="g in group.getCategorizedNodes('publicationtype.name') | orderBy:'getProperty(\'type.sorting\')'">

                                    <table class="table no-margin no-padding">
                                        <thead>
                                        <tr>
                                            <th class="clickable publicationsHeader">
                                                <a href="#">{{g.getLabel()}}</a>
                                            </th>
                                        </tr>
                                        </thead>
                                        <tbody>

                                        <tr ng-repeat="node in g.getNodes(limit[g.getLabel()] === undefined ? 10 : limit[g.getLabel()])"
                                            data-node-id="{{node.identifier}}">
                                            <td data-ng-if="node.getProperty('url') == ''">

                                                <div>
                                                            <span data-ng-if="node.getProperty('citationstyle') != ''"
                                                                  data-ng-bind-html="node.getProperty('citationstyle')"></span>
                                                    <span data-ng-if="node.getProperty('citationstyle') == ''">{{node.getProperty('title')}}</span>
                                                </div>
                                            </td>
                                            <td data-ng-if="node.getProperty('url') != ''">
                                                <div>

                                                    <a href="{{node.getProperty('url')}}" target="_blank">
                                                                <span data-ng-if="node.getProperty('citationstyle') != ''"
                                                                      data-ng-bind-html="node.getProperty('citationstyle')"></span>
                                                        <span data-ng-if="node.getProperty('citationstyle') == ''">{{node.getProperty('title')}}</span>
                                                    </a>
                                                </div>
                                            </td>
                                        </tr>
                                        <tfoot>
                                        <tr>
                                            <td data-ng-class="{'col-center' : g.count() > limit[g.getLabel()] || (g.count() > 10 && limit[g.getLabel()] === undefined)}">
                                                <a data-ng-click="limit[g.getLabel()] === undefined ? limit[g.getLabel()] = 20 : limit[g.getLabel()] = limit[g.getLabel()] + 10"
                                                   class="btn loadMore"
                                                   data-ng-if="g.count() > limit[g.getLabel()] || (g.count() > 10 && limit[g.getLabel()] === undefined)">
                                                    mehr anzeigen
                                                    <span>
                                                        <span data-ng-bind="limit[g.getLabel()] !== undefined ? limit[g.getLabel()] : 10"></span>
                                                        <span class="counter-divider">von</span>
                                                        <span data-ng-bind="g.count()"></span>
                                                    </span>
                                                </a>
                                            </td>
                                        </tr>
                                        </tfoot>
                                    </table>


                                </div>


                            </div>

                            <div class="ppdb-list further-education-special-search" data-ng-switch-when="Weiterbildungsskurse">

                                <div class="results-table">
                                    <div class="table-responsive">
                                        <table class="table">
                                            <thead>
                                            <tr>
                                                <th>
                                                    Beschreibung
                                                </th>
                                                <th>
                                                    Nummer
                                                </th>
                                                <th class="centered-column">
                                                    Buchbar
                                                </th>
                                                <th class="centered-column">
                                                    Typ
                                                </th>
                                            </tr>
                                            </thead>
                                            <tbody ng-repeat="node in group.getNodes()"
                                                   id="node-{{result.getIdentifier()}}-{{$index}}">
                                            <tr class="icon hat clickable"
                                                data-ng-class="{open: isOpen(node),noborder: $index > 0}"
                                                data-ng-click="setOpen(node,$index,result.getIdentifier());">
                                                <td>
                                    <span data-ng-if="!node.currentyear"
                                          data-ng-init="node.currentyear = node.getProperty('years.0')"></span>
                                                    <span class="oi"
                                                          data-ng-class="{'oi-caret-right': !isOpen(node), 'oi-caret-bottom': isOpen(node)}"></span>

                                                    <span data-ng-bind="node.getProperty('title')"></span>
                                                </td>
                                                <td class="course-number">
                                                    <span data-ng-bind="node.getProperty('nr')"></span>
                                                </td>
                                                <td class="centered-column">
                                                    <i class="fa fa-circle bookable" aria-hidden="true"
                                                       data-ng-if="node.getProperty('years.Bookable').indexOf(true) > -1"></i>
                                                    <i class="fa fa-circle booked-out" aria-hidden="true"
                                                       data-ng-if="node.getProperty('years.Bookable').indexOf(true) == -1"></i>
                                                    <!--                                    <br>
                                                                                        <i class="fa fa-info-circle booking-info" aria-hidden="true"></i>-->
                                                </td>
                                                <td class="course-type centered-column">
                                                    <i class="fa fa-graduation-cap" alt="Studiengang" aria-hidden="true"
                                                       data-ng-if="node.getNodeType() == 'phlu-neos-nodetypes-course-study-furthereducation'"></i>
                                                    <i class="fa fa-calendar" alt="Veranstaltung" aria-hidden="true"
                                                       data-ng-if="node.getNodeType() == 'phlu-neos-nodetypes-course-event-furthereducation'"></i>
                                                    <i class="fa fa-book" alt="Kurs" aria-hidden="true"
                                                       data-ng-if="node.getNodeType() == 'phlu-neos-nodetypes-course-module-furthereducation'"></i>

                                                </td>
                                            </tr>
                                            <tr class="result-preview" data-ng-show="isOpen(node)">
                                                <td colspan="4">
                                                    <div class="result-preview-contents">
                                                        <span data-ng-bind="node.getPreview('description',-1)"></span>

                                                        <table class="table">
                                                            <tbody>
                                                            <tr class="mobile-view-tablerow-only">
                                                                <td>
                                                                    Kursnummer
                                                                    <div class="mobile-view-columns">
                                                                        <span data-ng-bind="node.getProperty('nr')"></span>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                            <tr class="mobile-view-tablerow-only">
                                                                <td>
                                                                    Buchbar
                                                                    <div class="mobile-view-columns">
                                                                        <i class="fa fa-circle bookable"
                                                                           aria-hidden="true"
                                                                           data-ng-if="node.getProperty('years.Bookable').indexOf(true) > -1"></i>
                                                                        <i class="fa fa-circle booked-out"
                                                                           aria-hidden="true"
                                                                           data-ng-if="node.getProperty('years.Bookable').indexOf(true) == -1"></i>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                            <tr class="mobile-view-tablerow-only">
                                                                <td>
                                                                    Typ
                                                                    <div class="mobile-view-columns">
                                                                        <i class="fa fa-graduation-cap"
                                                                           alt="Studiengang"
                                                                           aria-hidden="true"
                                                                           data-ng-if="node.getNodeType() == 'phlu-neos-nodetypes-course-study-furthereducation'"></i>
                                                                        <i class="fa fa-calendar" alt="Veranstaltung"
                                                                           aria-hidden="true"
                                                                           data-ng-if="node.getNodeType() == 'phlu-neos-nodetypes-course-event-furthereducation'"></i>
                                                                        <i class="fa fa-book" alt="Kurs"
                                                                           aria-hidden="true"
                                                                           data-ng-if="node.getNodeType() == 'phlu-neos-nodetypes-course-module-furthereducation'"></i>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                            <tr class="desktop-view"
                                                                data-ng-if="node.getProperty('graduation')">
                                                                <td>
                                                                    Studienziel
                                                                    <div class="mobile-view-columns"
                                                                         data-ng-bind="node.getProperty('graduation')">
                                                                    </div>
                                                                </td>
                                                                <td data-ng-bind="node.getProperty('graduation')">
                                                                    <span data-ng-bind="node.getProperty('graduation')"></span>

                                                                </td>
                                                            </tr>
                                                            <tr class="desktop-view"
                                                                data-ng-if="node.getProperty('ects')">
                                                                <td>
                                                                    ETCS-Punkte
                                                                    <div class="mobile-view-columns"
                                                                         data-ng-bind="node.getProperty('ects')">

                                                                    </div>
                                                                </td>
                                                                <td data-ng-bind="node.getProperty('ects')">

                                                                </td>
                                                            </tr>
                                                            <tr class="desktop-view"
                                                                data-ng-if="node.currentyear.StartText">
                                                                <td>
                                                                    Beginn
                                                                    <div class="mobile-view-columns">
                                                                        <div class="input-group-btn"
                                                                             data-ng-if="node.getProperty('years').length > 1">
                                                                            <button type="button"
                                                                                    class="btn btn-default dropdown-toggle"
                                                                                    data-toggle="dropdown"
                                                                                    aria-haspopup="true"
                                                                                    aria-expanded="false">
                                                                                <span data-ng-bind="node.currentyear.StartText | castDate"></span>
                                                                            </button>
                                                                            <ul class="dropdown-menu">
                                                                                <li class="clickable"
                                                                                    data-ng-repeat="year in node.getProperty('years')"
                                                                                    data-ng-click="node.currentyear = year;">
                                                                                    <a data-ng-click="node.currentyear = year;">
                                                                                        <span data-ng-bind="year.StartText | castDate"></span>
                                                                                    </a>
                                                                                </li>
                                                                            </ul>
                                                                        </div>
                                                                        <div data-ng-if="node.getProperty('years').length == 1">
                                                                            <div>
                                                                                <span data-ng-bind="node.currentyear.StartText | castDate"></span>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </td>
                                                                <td>
                                                                    <div class="input-group-btn"
                                                                         data-ng-if="node.getProperty('years').length > 1">
                                                                        <button type="button"
                                                                                class="btn btn-default dropdown-toggle"
                                                                                data-toggle="dropdown"
                                                                                aria-haspopup="true"
                                                                                aria-expanded="false">
                                                                            <span data-ng-bind="node.currentyear.StartText | castDate"></span>
                                                                        </button>
                                                                        <ul class="dropdown-menu">
                                                                            <li class="clickable"
                                                                                data-ng-repeat="year in node.getProperty('years')"
                                                                                data-ng-click="setCurrentYear(node,year)">
                                                                                <a data-ng-click="node.currentyear = year;">
                                                                                    <span data-ng-bind="year.StartText | castDate"></span>
                                                                                </a>
                                                                            </li>
                                                                        </ul>
                                                                    </div>
                                                                    <div data-ng-if="node.getProperty('years').length == 1">
                                                                        <div>
                                                                            <span data-ng-bind="node.currentyear.StartText | castDate"></span>
                                                                        </div>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                            </tbody>
                                                        </table>

                                                    </div>
                                                    <div class="details">


                                                        <a class="btn btn-primary"
                                                           data-ng-if="currentYears[node.identifier].url"
                                                           data-ng-href="{{currentYears[node.identifier].url}}">
                                                            Details
                                                        </a>
                                                        <a class="btn btn-primary"
                                                           data-ng-if="!currentYears[node.identifier].url"
                                                           data-ng-href="{{node.getUrl()}}">
                                                            Details
                                                        </a>
                                                    </div>
                                                    <div class="shareAndRegister">
                                                        <a class="btn btn-primary share"
                                                           id="share-{{result.getIdentifier()}}-{{$index}}"
                                                           addthis:url="{{node.getUrl(true)}}"
                                                           addthis:title="{{node.getProperty('title')}}">
                                                            <img src="{f:uri.resource(package: 'Phlu.Corporate', path: 'Images/wb-share-btn.svg')}"
                                                                 width="32" height="32" border="0" alt="Share"/>
                                                            <br>
                                                            <span class="shareText">
                                            Teilen
                                        </span>
                                                        </a>

                                                        <a class="btn btn-primary"
                                                           data-ng-if="currentYears[node.identifier].RegistrationLink.indexOf('www.phlu.ch/') < 0"
                                                           data-ng-show="currentYears[node.identifier].RegistrationLink"
                                                           data-ng-href="{{currentYears[node.identifier].RegistrationLink}}">
                                                            Anmelden
                                                        </a>

                                                        <a class="btn btn-primary"
                                                           data-ng-if="currentYears[node.identifier].RegistrationLink.indexOf('www.phlu.ch/') > 0"
                                                           data-ng-show="currentYears[node.identifier].RegistrationLink"
                                                           data-ng-href="{{node.getUrl()}}">
                                                            Anmelden
                                                        </a>
                                                    </div>


                                                </td>
                                            </tr>
                                            </tbody>

                                        </table>
                                    </div>
                                </div>

                            </div>

                            <div class="ppdb-list further-education-special-search"
                                 data-ng-switch-when="WeiterbildungsstudiengÃ¤nge">
                                <div class="results-table">
                                    <div class="table-responsive">
                                        <table class="table">
                                            <thead>
                                            <tr>
                                                <th>
                                                    Beschreibung
                                                </th>
                                                <th>
                                                    Nummer
                                                </th>
                                                <th class="centered-column">
                                                    Buchbar
                                                </th>
                                                <th class="centered-column">
                                                    Typ
                                                </th>
                                            </tr>
                                            </thead>
                                            <tbody ng-repeat="node in group.getNodes()"
                                                   id="node-{{result.getIdentifier()}}-{{$index}}">
                                            <tr class="icon hat clickable"
                                                data-ng-class="{open: isOpen(node),noborder: $index > 0}"
                                                data-ng-click="setOpen(node,$index,result.getIdentifier());">
                                                <td>
                                    <span data-ng-if="!node.currentyear"
                                          data-ng-init="node.currentyear = node.getProperty('years.0')"></span>
                                                    <span class="oi"
                                                          data-ng-class="{'oi-caret-right': !isOpen(node), 'oi-caret-bottom': isOpen(node)}"></span>

                                                    <span data-ng-bind="node.getProperty('title')"></span>
                                                </td>
                                                <td class="course-number">
                                                    <span data-ng-bind="node.getProperty('nr')"></span>
                                                </td>
                                                <td class="centered-column">
                                                    <i class="fa fa-circle bookable" aria-hidden="true"
                                                       data-ng-if="node.getProperty('years.Bookable').indexOf(true) > -1"></i>
                                                    <i class="fa fa-circle booked-out" aria-hidden="true"
                                                       data-ng-if="node.getProperty('years.Bookable').indexOf(true) == -1"></i>
                                                    <!--                                    <br>
                                                                                        <i class="fa fa-info-circle booking-info" aria-hidden="true"></i>-->
                                                </td>
                                                <td class="course-type centered-column">
                                                    <i class="fa fa-graduation-cap" alt="Studiengang" aria-hidden="true"
                                                       data-ng-if="node.getNodeType() == 'phlu-neos-nodetypes-course-study-furthereducation'"></i>
                                                    <i class="fa fa-calendar" alt="Veranstaltung" aria-hidden="true"
                                                       data-ng-if="node.getNodeType() == 'phlu-neos-nodetypes-course-event-furthereducation'"></i>
                                                    <i class="fa fa-book" alt="Kurs" aria-hidden="true"
                                                       data-ng-if="node.getNodeType() == 'phlu-neos-nodetypes-course-module-furthereducation'"></i>

                                                </td>
                                            </tr>
                                            <tr class="result-preview" data-ng-show="isOpen(node)">
                                                <td colspan="4">
                                                    <div class="result-preview-contents">
                                                        <span data-ng-bind="node.getPreview('description',-1)"></span>

                                                        <table class="table">
                                                            <tbody>
                                                            <tr class="mobile-view-tablerow-only">
                                                                <td>
                                                                    Kursnummer
                                                                    <div class="mobile-view-columns">
                                                                        <span data-ng-bind="node.getProperty('nr')"></span>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                            <tr class="mobile-view-tablerow-only">
                                                                <td>
                                                                    Buchbar
                                                                    <div class="mobile-view-columns">
                                                                        <i class="fa fa-circle bookable"
                                                                           aria-hidden="true"
                                                                           data-ng-if="node.getProperty('years.Bookable').indexOf(true) > -1"></i>
                                                                        <i class="fa fa-circle booked-out"
                                                                           aria-hidden="true"
                                                                           data-ng-if="node.getProperty('years.Bookable').indexOf(true) == -1"></i>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                            <tr class="mobile-view-tablerow-only">
                                                                <td>
                                                                    Typ
                                                                    <div class="mobile-view-columns">
                                                                        <i class="fa fa-graduation-cap"
                                                                           alt="Studiengang"
                                                                           aria-hidden="true"
                                                                           data-ng-if="node.getNodeType() == 'phlu-neos-nodetypes-course-study-furthereducation'"></i>
                                                                        <i class="fa fa-calendar" alt="Veranstaltung"
                                                                           aria-hidden="true"
                                                                           data-ng-if="node.getNodeType() == 'phlu-neos-nodetypes-course-event-furthereducation'"></i>
                                                                        <i class="fa fa-book" alt="Kurs"
                                                                           aria-hidden="true"
                                                                           data-ng-if="node.getNodeType() == 'phlu-neos-nodetypes-course-module-furthereducation'"></i>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                            <tr class="desktop-view"
                                                                data-ng-if="node.getProperty('graduation')">
                                                                <td>
                                                                    Studienziel
                                                                    <div class="mobile-view-columns"
                                                                         data-ng-bind="node.getProperty('graduation')">
                                                                    </div>
                                                                </td>
                                                                <td data-ng-bind="node.getProperty('graduation')">
                                                                    <span data-ng-bind="node.getProperty('graduation')"></span>

                                                                </td>
                                                            </tr>
                                                            <tr class="desktop-view"
                                                                data-ng-if="node.getProperty('ects')">
                                                                <td>
                                                                    ETCS-Punkte
                                                                    <div class="mobile-view-columns"
                                                                         data-ng-bind="node.getProperty('ects')">

                                                                    </div>
                                                                </td>
                                                                <td data-ng-bind="node.getProperty('ects')">

                                                                </td>
                                                            </tr>
                                                            <tr class="desktop-view"
                                                                data-ng-if="node.currentyear.StartText">
                                                                <td>
                                                                    Beginn
                                                                    <div class="mobile-view-columns">
                                                                        <div class="input-group-btn"
                                                                             data-ng-if="node.getProperty('years').length > 1">
                                                                            <button type="button"
                                                                                    class="btn btn-default dropdown-toggle"
                                                                                    data-toggle="dropdown"
                                                                                    aria-haspopup="true"
                                                                                    aria-expanded="false">
                                                                                <span data-ng-bind="node.currentyear.StartText | castDate"></span>
                                                                            </button>
                                                                            <ul class="dropdown-menu">
                                                                                <li class="clickable"
                                                                                    data-ng-repeat="year in node.getProperty('years')"
                                                                                    data-ng-click="node.currentyear = year;">
                                                                                    <a data-ng-click="node.currentyear = year;">
                                                                                        <span data-ng-bind="year.StartText | castDate"></span>
                                                                                    </a>
                                                                                </li>
                                                                            </ul>
                                                                        </div>
                                                                        <div data-ng-if="node.getProperty('years').length == 1">
                                                                            <div>
                                                                                <span data-ng-bind="node.currentyear.StartText | castDate"></span>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </td>
                                                                <td>
                                                                    <div class="input-group-btn"
                                                                         data-ng-if="node.getProperty('years').length > 1">
                                                                        <button type="button"
                                                                                class="btn btn-default dropdown-toggle"
                                                                                data-toggle="dropdown"
                                                                                aria-haspopup="true"
                                                                                aria-expanded="false">
                                                                            <span data-ng-bind="node.currentyear.StartText | castDate"></span>
                                                                        </button>
                                                                        <ul class="dropdown-menu">
                                                                            <li class="clickable"
                                                                                data-ng-repeat="year in node.getProperty('years')"
                                                                                data-ng-click="setCurrentYear(node,year)">
                                                                                <a data-ng-click="node.currentyear = year;">
                                                                                    <span data-ng-bind="year.StartText | castDate"></span>
                                                                                </a>
                                                                            </li>
                                                                        </ul>
                                                                    </div>
                                                                    <div data-ng-if="node.getProperty('years').length == 1">
                                                                        <div>
                                                                            <span data-ng-bind="node.currentyear.StartText | castDate"></span>
                                                                        </div>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                            </tbody>
                                                        </table>

                                                    </div>
                                                    <div class="details">


                                                        <a class="btn btn-primary"
                                                           data-ng-if="currentYears[node.identifier].url"
                                                           data-ng-href="{{currentYears[node.identifier].url}}">
                                                            Details
                                                        </a>
                                                        <a class="btn btn-primary"
                                                           data-ng-if="!currentYears[node.identifier].url"
                                                           data-ng-href="{{node.getUrl()}}">
                                                            Details
                                                        </a>
                                                    </div>
                                                    <div class="shareAndRegister">
                                                        <a class="btn btn-primary share"
                                                           id="share-{{result.getIdentifier()}}-{{$index}}"
                                                           addthis:url="{{node.getUrl(true)}}"
                                                           addthis:title="{{node.getProperty('title')}}">
                                                            <img src="{f:uri.resource(package: 'Phlu.Corporate', path: 'Images/wb-share-btn.svg')}"
                                                                 width="32" height="32" border="0" alt="Share"/>
                                                            <br>
                                                            <span class="shareText">
                                            Teilen
                                        </span>
                                                        </a>

                                                        <a class="btn btn-primary"
                                                           data-ng-if="currentYears[node.identifier].RegistrationLink.indexOf('www.phlu.ch/') < 0"
                                                           data-ng-show="currentYears[node.identifier].RegistrationLink"
                                                           data-ng-href="{{currentYears[node.identifier].RegistrationLink}}">
                                                            Anmelden
                                                        </a>

                                                        <a class="btn btn-primary"
                                                           data-ng-if="currentYears[node.identifier].RegistrationLink.indexOf('www.phlu.ch/') > 0"
                                                           data-ng-show="currentYears[node.identifier].RegistrationLink"
                                                           data-ng-href="{{node.getUrl()}}">
                                                            Anmelden
                                                        </a>
                                                    </div>


                                                </td>
                                            </tr>
                                            </tbody>

                                        </table>
                                    </div>
                                </div>
                            </div>

                            <div class="ppdb-list further-education-special-search" data-ng-switch-when="Weiterbildungsveranstaltungen">

                                <div class="results-table">
                                    <div class="table-responsive">
                                        <table class="table">
                                            <thead>
                                            <tr>
                                                <th>
                                                    Beschreibung
                                                </th>
                                                <th>
                                                    Nummer
                                                </th>
                                                <th class="centered-column">
                                                    Buchbar
                                                </th>
                                                <th class="centered-column">
                                                    Typ
                                                </th>
                                            </tr>
                                            </thead>
                                            <tbody ng-repeat="node in group.getNodes()"
                                                   id="node-{{result.getIdentifier()}}-{{$index}}">
                                            <tr class="icon hat clickable"
                                                data-ng-class="{open: isOpen(node),noborder: $index > 0}"
                                                data-ng-click="setOpen(node,$index,result.getIdentifier());">
                                                <td>
                                    <span data-ng-if="!node.currentyear"
                                          data-ng-init="node.currentyear = node.getProperty('years.0')"></span>
                                                    <span class="oi"
                                                          data-ng-class="{'oi-caret-right': !isOpen(node), 'oi-caret-bottom': isOpen(node)}"></span>

                                                    <span data-ng-bind="node.getProperty('title')"></span>
                                                </td>
                                                <td class="course-number">
                                                    <span data-ng-bind="node.getProperty('nr')"></span>
                                                </td>
                                                <td class="centered-column">
                                                    <i class="fa fa-circle bookable" aria-hidden="true"
                                                       data-ng-if="node.getProperty('years.Bookable').indexOf(true) > -1"></i>
                                                    <i class="fa fa-circle booked-out" aria-hidden="true"
                                                       data-ng-if="node.getProperty('years.Bookable').indexOf(true) == -1"></i>
                                                    <!--                                    <br>
                                                                                        <i class="fa fa-info-circle booking-info" aria-hidden="true"></i>-->
                                                </td>
                                                <td class="course-type centered-column">
                                                    <i class="fa fa-graduation-cap" alt="Studiengang" aria-hidden="true"
                                                       data-ng-if="node.getNodeType() == 'phlu-neos-nodetypes-course-study-furthereducation'"></i>
                                                    <i class="fa fa-calendar" alt="Veranstaltung" aria-hidden="true"
                                                       data-ng-if="node.getNodeType() == 'phlu-neos-nodetypes-course-event-furthereducation'"></i>
                                                    <i class="fa fa-book" alt="Kurs" aria-hidden="true"
                                                       data-ng-if="node.getNodeType() == 'phlu-neos-nodetypes-course-module-furthereducation'"></i>

                                                </td>
                                            </tr>
                                            <tr class="result-preview" data-ng-show="isOpen(node)">
                                                <td colspan="4">
                                                    <div class="result-preview-contents">
                                                        <span data-ng-bind="node.getPreview('description',-1)"></span>

                                                        <table class="table">
                                                            <tbody>
                                                            <tr class="mobile-view-tablerow-only">
                                                                <td>
                                                                    Kursnummer
                                                                    <div class="mobile-view-columns">
                                                                        <span data-ng-bind="node.getProperty('nr')"></span>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                            <tr class="mobile-view-tablerow-only">
                                                                <td>
                                                                    Buchbar
                                                                    <div class="mobile-view-columns">
                                                                        <i class="fa fa-circle bookable"
                                                                           aria-hidden="true"
                                                                           data-ng-if="node.getProperty('years.Bookable').indexOf(true) > -1"></i>
                                                                        <i class="fa fa-circle booked-out"
                                                                           aria-hidden="true"
                                                                           data-ng-if="node.getProperty('years.Bookable').indexOf(true) == -1"></i>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                            <tr class="mobile-view-tablerow-only">
                                                                <td>
                                                                    Typ
                                                                    <div class="mobile-view-columns">
                                                                        <i class="fa fa-graduation-cap"
                                                                           alt="Studiengang"
                                                                           aria-hidden="true"
                                                                           data-ng-if="node.getNodeType() == 'phlu-neos-nodetypes-course-study-furthereducation'"></i>
                                                                        <i class="fa fa-calendar" alt="Veranstaltung"
                                                                           aria-hidden="true"
                                                                           data-ng-if="node.getNodeType() == 'phlu-neos-nodetypes-course-event-furthereducation'"></i>
                                                                        <i class="fa fa-book" alt="Kurs"
                                                                           aria-hidden="true"
                                                                           data-ng-if="node.getNodeType() == 'phlu-neos-nodetypes-course-module-furthereducation'"></i>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                            <tr class="desktop-view"
                                                                data-ng-if="node.getProperty('graduation')">
                                                                <td>
                                                                    Studienziel
                                                                    <div class="mobile-view-columns"
                                                                         data-ng-bind="node.getProperty('graduation')">
                                                                    </div>
                                                                </td>
                                                                <td data-ng-bind="node.getProperty('graduation')">
                                                                    <span data-ng-bind="node.getProperty('graduation')"></span>

                                                                </td>
                                                            </tr>
                                                            <tr class="desktop-view"
                                                                data-ng-if="node.getProperty('ects')">
                                                                <td>
                                                                    ETCS-Punkte
                                                                    <div class="mobile-view-columns"
                                                                         data-ng-bind="node.getProperty('ects')">

                                                                    </div>
                                                                </td>
                                                                <td data-ng-bind="node.getProperty('ects')">

                                                                </td>
                                                            </tr>
                                                            <tr class="desktop-view"
                                                                data-ng-if="node.currentyear.StartText">
                                                                <td>
                                                                    Beginn
                                                                    <div class="mobile-view-columns">
                                                                        <div class="input-group-btn"
                                                                             data-ng-if="node.getProperty('years').length > 1">
                                                                            <button type="button"
                                                                                    class="btn btn-default dropdown-toggle"
                                                                                    data-toggle="dropdown"
                                                                                    aria-haspopup="true"
                                                                                    aria-expanded="false">
                                                                                <span data-ng-bind="node.currentyear.StartText | castDate"></span>
                                                                            </button>
                                                                            <ul class="dropdown-menu">
                                                                                <li class="clickable"
                                                                                    data-ng-repeat="year in node.getProperty('years')"
                                                                                    data-ng-click="node.currentyear = year;">
                                                                                    <a data-ng-click="node.currentyear = year;">
                                                                                        <span data-ng-bind="year.StartText | castDate"></span>
                                                                                    </a>
                                                                                </li>
                                                                            </ul>
                                                                        </div>
                                                                        <div data-ng-if="node.getProperty('years').length == 1">
                                                                            <div>
                                                                                <span data-ng-bind="node.currentyear.StartText | castDate"></span>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </td>
                                                                <td>
                                                                    <div class="input-group-btn"
                                                                         data-ng-if="node.getProperty('years').length > 1">
                                                                        <button type="button"
                                                                                class="btn btn-default dropdown-toggle"
                                                                                data-toggle="dropdown"
                                                                                aria-haspopup="true"
                                                                                aria-expanded="false">
                                                                            <span data-ng-bind="node.currentyear.StartText | castDate"></span>
                                                                        </button>
                                                                        <ul class="dropdown-menu">
                                                                            <li class="clickable"
                                                                                data-ng-repeat="year in node.getProperty('years')"
                                                                                data-ng-click="setCurrentYear(node,year)">
                                                                                <a data-ng-click="node.currentyear = year;">
                                                                                    <span data-ng-bind="year.StartText | castDate"></span>
                                                                                </a>
                                                                            </li>
                                                                        </ul>
                                                                    </div>
                                                                    <div data-ng-if="node.getProperty('years').length == 1">
                                                                        <div>
                                                                            <span data-ng-bind="node.currentyear.StartText | castDate"></span>
                                                                        </div>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                            </tbody>
                                                        </table>

                                                    </div>
                                                    <div class="details">


                                                        <a class="btn btn-primary"
                                                           data-ng-if="currentYears[node.identifier].url"
                                                           data-ng-href="{{currentYears[node.identifier].url}}">
                                                            Details
                                                        </a>
                                                        <a class="btn btn-primary"
                                                           data-ng-if="!currentYears[node.identifier].url"
                                                           data-ng-href="{{node.getUrl()}}">
                                                            Details
                                                        </a>
                                                    </div>
                                                    <div class="shareAndRegister">
                                                        <a class="btn btn-primary share"
                                                           id="share-{{result.getIdentifier()}}-{{$index}}"
                                                           addthis:url="{{node.getUrl(true)}}"
                                                           addthis:title="{{node.getProperty('title')}}">
                                                            <img src="{f:uri.resource(package: 'Phlu.Corporate', path: 'Images/wb-share-btn.svg')}"
                                                                 width="32" height="32" border="0" alt="Share"/>
                                                            <br>
                                                            <span class="shareText">
                                            Teilen
                                        </span>
                                                        </a>

                                                        <a class="btn btn-primary"
                                                           data-ng-if="currentYears[node.identifier].RegistrationLink.indexOf('www.phlu.ch/') < 0"
                                                           data-ng-show="currentYears[node.identifier].RegistrationLink"
                                                           data-ng-href="{{currentYears[node.identifier].RegistrationLink}}">
                                                            Anmelden
                                                        </a>

                                                        <a class="btn btn-primary"
                                                           data-ng-if="currentYears[node.identifier].RegistrationLink.indexOf('www.phlu.ch/') > 0"
                                                           data-ng-show="currentYears[node.identifier].RegistrationLink"
                                                           data-ng-href="{{node.getUrl()}}">
                                                            Anmelden
                                                        </a>
                                                    </div>


                                                </td>
                                            </tr>
                                            </tbody>

                                        </table>
                                    </div>
                                </div>

                            </div>

                            <div class="ppdb-list" data-ng-switch-when="Projekte">


                                <div class=" results-table">
                                    <div class="table-responsive">
                                        <table class="table">
                                            <thead>
                                            <tr>
                                                <th class="clickable">
                                                    <a href="#">Projektname</a>
                                                </th>
                                                <th class="clickable">
                                                    <a href="#">Schwerpunkte</a>
                                                </th>
                                            </tr>
                                            </thead>

                                            <tbody ng-repeat="node in group.getNodes()"
                                                   data-ng-click="node.isopen = node.isopen ? false : true">
                                            <tr data-ng-class="{open: node.isopen,noborder: $index > 0}"
                                                class="clickable">
                                                <td>
                                                    <span class="oi"
                                                          data-ng-class="{'oi-caret-right': !node.isopen, 'oi-caret-bottom': node.isopen}"></span>
                                                    <span>{{node.getProperty('title')}}</span>
                                                    <div class="mobile-view-columns researchmainfocus">
                                                                <span class="header">
                                                                    Schwerpunkte
                                                                </span>
                                                        <span>
                                                                    <ul>
                                                                        <li data-ng-repeat="focus in node.getProperty('researchmainfocus') track by $index"
                                                                            data-ng-bind="focus.name"></li>
                                                                    </ul>
                                                                </span>
                                                    </div>
                                                </td>
                                                <td class="researchmainfocus">
                                                    <ul>
                                                        <li data-ng-repeat="focus in node.getProperty('researchmainfocus') track by $index"
                                                            data-ng-bind="focus.name">

                                                        </li>
                                                    </ul>
                                                </td>
                                            </tr>
                                            <tr class="result-preview" data-ng-show="node.isopen">
                                                <td colspan="2">
                                                    <div class="project-preview">
                                                        <div ng-bind-html="node.getProperty('abstracttextgerman').substr(0,255) + '...'"></div>
                                                        <a class="btn btn-primary" href="{{node.getUrl()}}">
                                                            Details
                                                        </a>
                                                    </div>
                                                </td>
                                            </tr>
                                            </tbody>

                                        </table>
                                    </div>

                                </div>


                            </div>


                            <div class="table-responsive" data-ng-switch-default>
                                <table class="table">
                                    <tbody>
                                    <tr ng-repeat="node in group.getNodes()"
                                        data-ng-if="!node.isTurboNode()">
                                        <td>
                                            <search data="node" view="group"></search>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>


                        </div>

                    </div>


                </div>
            </div>


            <div class="row results-table" data-ng-if="result.getGrouped().count() == 1">
                <div class="col-xs-12 tab-content">

                    <div class="result-panel tab-pane nofilter fade active in" id="{{group.getLabel()}}"
                         role="tabpanel"
                         ng-repeat="group in result.getGrouped().getItems()">
                        <div class="table-responsive">
                            <table class="table">
                                <tbody>
                                <tr ng-repeat="node in group.getNodes()"
                                    data-ng-if="!node.isTurboNode()">
                                    <td class="clickable">
                                        <search data="node" view="group"></search>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>


                </div>
            </div>


        </div>

    </div>

</div>